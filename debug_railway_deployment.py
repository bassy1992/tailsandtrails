#!/usr/bin/env python3
"""
Debug Railway deployment storage configuration
"""
import os
import sys
import django

# Setup Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'Tback.tback_api.settings')
sys.path.append('Tback')

try:
    django.setup()
    from django.conf import settings
    from django.core.files.storage import default_storage
    
    print("üîç Railway Deployment Debug")
    print("=" * 50)
    
    # Check environment
    print(f"Environment Variables:")
    print(f"  SPACES_KEY: {'‚úÖ Set' if os.getenv('SPACES_KEY') else '‚ùå Not set'}")
    print(f"  SPACES_SECRET: {'‚úÖ Set' if os.getenv('SPACES_SECRET') else '‚ùå Not set'}")
    
    # Check Django settings
    print(f"\nDjango Settings:")
    print(f"  DEFAULT_FILE_STORAGE: {settings.DEFAULT_FILE_STORAGE}")
    print(f"  MEDIA_URL: {settings.MEDIA_URL}")
    print(f"  AWS_ACCESS_KEY_ID: {'‚úÖ Set' if settings.AWS_ACCESS_KEY_ID else '‚ùå Not set'}")
    print(f"  AWS_SECRET_ACCESS_KEY: {'‚úÖ Set' if settings.AWS_SECRET_ACCESS_KEY else '‚ùå Not set'}")
    
    # Check actual storage
    print(f"\nActual Storage:")
    print(f"  Backend: {default_storage.__class__.__name__}")
    print(f"  Module: {default_storage.__class__.__module__}")
    
    # Check package availability
    print(f"\nPackage Check:")
    try:
        import boto3
        print(f"  ‚úÖ boto3 available: {boto3.__version__}")
    except ImportError as e:
        print(f"  ‚ùå boto3 not available: {e}")
    
    try:
        import storages
        print(f"  ‚úÖ storages available")
        from storages.backends.s3boto3 import S3Boto3Storage
        print(f"  ‚úÖ S3Boto3Storage importable")
    except ImportError as e:
        print(f"  ‚ùå storages not available: {e}")
    
    print(f"\n" + "=" * 50)
    
except Exception as e:
    print(f"‚ùå Django setup failed: {e}")
    import traceback
    traceback.print_exc()